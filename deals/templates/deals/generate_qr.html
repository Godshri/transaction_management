{% extends 'deals/base.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}Генерация QR-кода - Управление сделками{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/generate_qr.js' %}"></script>
{% endblock %}

{% block content %}
<h1>Генерация QR-кода для товара</h1>

<form method="post" id="qr-form">
    {% csrf_token %}

    <div class="field-group">
        <label for="product-search">Поиск товара</label>
        <input type="text" id="product-search" class="form-control"
               placeholder="Начните вводить название товара...">
        <span class="form-hint">Введите название товара и выберите из списка</span>

        <div id="search-results">
            <ul id="results-list"></ul>
        </div>
    </div>

    <div class="field-group">
        <label for="product_id">ID товара *</label>
        <input type="text" id="product_id" name="product_id" required
               class="form-control" placeholder="ID товара">
        <span class="form-hint">Введите числовой ID товара из Битрикс24</span>
    </div>

    <div class="field-group">
        <label>Информация о товаре</label>
        <div id="product-info" class="product-info" style="display: none;">
            <h4 id="product-name">Название товара</h4>
            <p id="product-price">Цена: <span id="price-value">0</span> ₽</p>
            <p id="product-description">
                Описание:
                <span id="short-description"></span>
                <span id="full-description" style="display: none;"></span>
                <span id="read-more-toggle" class="read-more-toggle" style="display: none;">читать дальше</span>
            </p>
            <div id="product-image-preview" style="display: none; margin-top: 10px;">
                <img id="preview-image" src="" alt="Превью товара" style="max-width: 200px; max-height: 200px;">
            </div>
        </div>
    </div>

    <div class="text-center mt-4">
        <button type="submit" class="button">Сгенерировать QR-код</button>
    </div>
</form>
{% endblock %}